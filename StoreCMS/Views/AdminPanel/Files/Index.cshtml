@model FilesViewModel[]
@{
    Layout = "CommonPage";
    Context.Items["PageStyle"] = "/styles/admin_panel/files/index.css";
    IFilesPageLocalization localization = Context.Items["FilesPageLocalization"] as IFilesPageLocalization;
    LinkedList<FilesViewModel> breadcrumbs = Context.Items["FilesPageBreadcrumbs"] as LinkedList<FilesViewModel>;
    User user = Context.Items["User"] as User;
}
<div class="breadcrumbList">
    @for (LinkedListNode<FilesViewModel> node = breadcrumbs.First; node != null; node = node.Next)
    {
        if (node.Next != null)
        {
            <a href="@Context.Request.Path?pageID=@((int)AdminPanelPages.Files)@(!string.IsNullOrEmpty(node.Value.Url) ? $"&path={node.Value.Url}" : string.Empty)">@Html.Raw(node.Value.Name)</a>
        }
        else
        {
            <div>@Html.Raw(node.Value.Name)</div>
        }
    }
</div>
<div class="actionList">
    @if (DataCheck.HasAccessTo(AdminPanelPages.UploadFile, user, Context))
    {
        <form method="post" class="uploadFileForm" enctype="multipart/form-data">
            <input type="hidden" name="pageID" value="@((int)AdminPanelPages.UploadFile)">
            <input type="hidden" name="path" value="@breadcrumbs.Last.Value.Url">
            <div class="inputFileButton">
                <label for="upload">@Html.Raw(localization.ChooseTheFile)</label>
                <input type="file" id="upload" name="uploadedFile" accept=".png, .jpg, .jpeg, .bmp, .gif, .css, .ico" />
            </div>
            <input type="submit" />
        </form>
    }
    @if (DataCheck.HasAccessTo(AdminPanelPages.CreateFolder, user, Context))
    {
        <form method="post" class="createFolerOrStyle">
            <input type="hidden" name="pageID" value="@((int)AdminPanelPages.CreateFolder)">
            <input type="hidden" name="path" value="@breadcrumbs.Last.Value.Url" />
            <input type="submit" value="@Html.Raw(localization.Create)" />
            <input type="text" name="name" placeholder="@Html.Raw(localization.FolderName)" />
        </form>
    }
    @if (DataCheck.HasAccessTo(AdminPanelPages.CreateFolder, user, Context))
    {
        <form method="post" class="createFolerOrStyle marginLeft">
            <input type="hidden" name="pageID" value="@((int)AdminPanelPages.CreateStyle)">
            <input type="hidden" name="path" value="@breadcrumbs.Last.Value.Url" />
            <input type="submit" value="@Html.Raw(localization.Create)" />
            <input type="text" name="name" placeholder="@Html.Raw(localization.CssFileName)" />
        </form>
    }
</div>
<table>
    <tr>
        <td>@Html.Raw(localization.Name)</td>
        <td></td>
    </tr>
    @foreach (var f in Model)
    {
        <tr>
            @if (!f.FileType.HasValue)
            {
                <td><a href="@Context.Request.Path?pageID=@((int)AdminPanelPages.Files)&path=@f.Url">@Html.Raw(localization.Folder): <b>@Html.Raw(f.Name)</b></a></td>
            }
            else if (f.FileType == FileTypeEnum.image)
            {
                <td><a href="@f.Url">@Html.Raw(localization.Image): <b>@Html.Raw(f.Name)</b></a></td>
            }
            else if (f.FileType == FileTypeEnum.style)
            {
                if (DataCheck.HasAccessTo(AdminPanelPages.EditStyle, user, Context))
                {
                    <td><a href="@Context.Request.Path?pageID=@((int)AdminPanelPages.EditStyle)&path=@f.Url">@Html.Raw(localization.Style): <b>@Html.Raw(f.Name)</b></a></td>
                }
                else
                {
                    <td><span>@Html.Raw(localization.Style): <b>@Html.Raw(f.Name)</b></span></td>
                }
            }
            <td>
                @if (DataCheck.HasAccessTo(AdminPanelPages.DeleteFileOrFolder, user, Context))
                {
                    if (f.CanDelete.Value)
                    {
                        <form method="post">
                            <input type="hidden" name="pageID" value="@((int)AdminPanelPages.DeleteFileOrFolder)">
                            <input type="hidden" name="path" value="@f.Url" />
                            <input type="submit" class="deleteButton" value="@Html.Raw(localization.Delete)" />
                        </form>
                    }
                    else
                    {
                        <input type="submit" class="disabledDeleteButton" disabled value="@Html.Raw(localization.Delete)" />
                    }
                }
            </td>
        </tr>
    }
</table>
